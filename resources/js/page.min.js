!function(a){var b=function(){var a="test";try{return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(b){return!1}}(),c=null;a(document).ready(function(){c=a("#review").length>0?new e:new d});var d=function(){g()},e=function(){var b=f();g(b),h(b),a("#comment-button").on("click",i(b))},f=function(){var c,d=window.location.href,e=d.split("/")[d.split("/").length-1];if(b){c=JSON.parse(localStorage.getItem("reviews")),c||(c=[]);var f=a.inArray(e,c);0>f?c.length>=15&&c.pop():c.splice(f,1),c.push(e),localStorage.setItem("reviews",JSON.stringify(c))}return e},g=function(b){b?b+="/":b="",a.ajax({type:"GET",url:"/review/"+b+"recommendations",data:j(JSON.parse(localStorage.getItem("reviews")))}).done(function(b){a("#recommendations").append(b)})},h=function(b){b&&a.ajax({type:"GET",url:"/review/"+b+"/comments"}).done(function(b){a("#comments").append(b)})},i=function(b){return function(){b&&a.ajax({type:"POST",url:"/review/"+b+"/comments"}).done(function(b){a("#comments").append(b)})}},j=function(a){var b={};if(!a)return b;for(var c=a.length-1;c>=0;--c)b[a[c]]=1;return console.log(b),b}}(jQuery);